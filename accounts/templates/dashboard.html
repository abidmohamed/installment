{% extends 'home.html' %}
{% load static %}
{% block content %}

<div class="row">
    <div class="col-xl-3 col-md-6 mb-4">
        <div class="card border-left-primary shadow h-100 py-2">
            <div class="card-body">
                <div class="row no-gutters align-items-center">
                    <div class="col mr-2">
                        <div class="text-xs font-weight-bold text-primary text-uppercase mb-1">Customers</div>
                        <div class="h5 mb-0 font-weight-bold text-gray-800">{{customerscount}}</div>
                    </div>
                    <div class="col-auto">
                        <i class="fas fa-user-tie fa-2x text-primary"></i>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="col-xl-3 col-md-6 mb-4">
        <div class="card border-left-success shadow h-100 py-2">
            <div class="card-body">
                <div class="row no-gutters align-items-center">
                    <div class="col mr-2">
                        <div class="text-xs font-weight-bold text-success text-uppercase mb-1">Sell Orders</div>
                        <div class="h5 mb-0 font-weight-bold text-gray-800">{{orderscount}}</div>
                    </div>
                    <div class="col-auto">
                        <i class="fas fa-clipboard-list fa-2x text-success"></i>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="col-xl-3 col-md-6 mb-4">
        <div class="card border-left-info shadow h-100 py-2">
            <div class="card-body">
                <div class="row no-gutters align-items-center">
                    <div class="col mr-2">
                        <div class="text-xs font-weight-bold text-info text-uppercase mb-1">Buy Orders</div>
                        <div class="h5 mb-0 font-weight-bold text-gray-800">{{buyorderscount}}</div>
                    </div>
                    <div class="col-auto">
                        <i class="fas fa-clipboard-list fa-2x text-info"></i>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="col-xl-3 col-md-6 mb-4">
        <div class="card border-left-warning shadow h-100 py-2">
            <div class="card-body">
                <div class="row no-gutters align-items-center">
                    <div class="col mr-2">
                        <div class="text-xs font-weight-bold text-warning text-uppercase mb-1">Suppliers</div>
                        <div class="h5 mb-0 font-weight-bold text-gray-800">{{supplierscount}}</div>
                    </div>
                    <div class="col-auto">
                        <i class="fas fa-truck fa-2x text-warning"></i>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- First Cards row Ends Here -->
    <br>
    <div class="col-xl-12 col-md-12 mb-4">
        <hr>
    </div>
    <br>
    <!-- Second Cards row Starts Here -->
    <div class="col-xl-3 col-md-6 mb-4">
        <div class="card border-left-primary shadow h-100 py-2">
            <div class="card-body">
                <div class="row no-gutters align-items-center">
                    <div class="col mr-2">
                        <div class="text-xs font-weight-bold text-primary text-uppercase mb-1">Customers Debt</div>
                        <div class="h5 mb-0 font-weight-bold text-gray-800">{{totaldebt}} DZD</div>
                    </div>
                    <div class="col-auto">
                        <i class="fas fa-user-tie fa-2x text-primary"></i>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="col-xl-3 col-md-6 mb-4">
        <div class="card border-left-success shadow h-100 py-2">
            <div class="card-body">
                <div class="row no-gutters align-items-center">
                    <div class="col mr-2">
                        <div class="text-xs font-weight-bold text-success text-uppercase mb-1">Total Sell Order</div>
                        <div class="h5 mb-0 font-weight-bold text-gray-800">{{totalsellorders}} DZD</div>
                    </div>
                    <div class="col-auto">
                        <i class="fas fa-clipboard-list fa-2x text-success"></i>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="col-xl-3 col-md-6 mb-4">
        <div class="card border-left-info shadow h-100 py-2">
            <div class="card-body">
                <div class="row no-gutters align-items-center">
                    <div class="col mr-2">
                        <div class="text-xs font-weight-bold text-info text-uppercase mb-1">Total Buy Orders</div>
                        <div class="h5 mb-0 font-weight-bold text-gray-800">{{totalbuyorders}} DZD</div>
                    </div>
                    <div class="col-auto">
                        <i class="fas fa-clipboard-list fa-2x text-info"></i>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="col-xl-3 col-md-6 mb-4">
        <div class="card border-left-warning shadow h-100 py-2">
            <div class="card-body">
                <div class="row no-gutters align-items-center">
                    <div class="col mr-2">
                        <div class="text-xs font-weight-bold text-warning text-uppercase mb-1">Suppliers Credit</div>
                        <div class="h5 mb-0 font-weight-bold text-gray-800">{{totalcredit}} DZD</div>
                    </div>
                    <div class="col-auto">
                        <i class="fas fa-truck fa-2x text-warning"></i>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- First Cards row Ends Here -->
    <br>
    <div class="col-xl-12 col-md-12 mb-4">
        <hr>
    </div>
    <br>
    <!-- Second Cards row Starts Here -->

</div>
    <!-- New row Starts Here -->
<div class="row mt-3">
    <div class="col-xl-12 col-md-12 mb-4">
        <div class="card shadow">
            <div class="card-body align-items-center">
                <h3 class="text-center text-primary font-weight-bold">
                   <i class="fas fa-chart-line text-primary-300"></i>
                    Statistics

                </h3>
            </div>
        </div>
    </div>
    <!-- Products Chart -->
    <div class="col-xl-6 col-md-6 col-sm-12 col-xs-12 mb-4">
        <div class="card shadow">
            <div class="card-body">
                <canvas id="productsChart" width="400" height="400"></canvas>
            </div>
        </div>
    </div>
    <!-- Ending Contracts -->
    <div class="col-xl-6 col-md-6 col-sm-12 col-xs-12 mb-4">
    <div class="card shadow">
            <div class="card-body">
                <table id="table_id" class="display text-center" >
                    <thead>
                    <tr>
                        <th>First and Last name</th>
                        <th>Start Date</th>
                        <th>End Date</th>
                        <th>Created</th>
                        <th>Updated</th>
                        <th></th>
                    </tr>
                    </thead>
                    <tbody>
                    {% for contract in endingcontracts %}
                    <tr>
                        <td>
                            {{contract.customer.firstname}}
                            {{contract.customer.lastname}}
                        </td>
                        <td>
                            {{contract.start_date}}
                        </td>
                        <td>
                            {{contract.end_date}}
                        </td>
                        <td>
                            {{contract.created}}
                        </td>
                        <td>
                            {{contract.updated}}
                        </td>

                        <td>
                            <a class="btn btn-success "
                               href="{% url 'customer:saving_contract' contract.id %}">Update</a>
                        </td>

                    </tr>
                    {% empty %}
                    <tr>

                           <h2>No Contracts</h2>
                    </tr>
                    {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>
{% endblock %}
{% block jsscript %}
<!-- Data Table  -->
<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.22/css/jquery.dataTables.css">

<script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/1.10.22/js/jquery.dataTables.js"></script>

<!-- custom javascript -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/themes/smoothness/jquery-ui.css">
<script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/chosen/1.8.7/chosen.jquery.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/chosen/1.8.7/chosen.min.css"/>
<!-- Data Table  -->
<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.22/css/jquery.dataTables.css">

<script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/1.10.22/js/jquery.dataTables.js"></script>
<!-- Chart -->
<script src="https://cdn.jsdelivr.net/npm/chart.js@2.8.0"></script>

<script type='text/javascript'>
//Data Table init
    $(document).ready( function () {
    $('#table_id').DataTable();
    } );

    // generate a random colors
    var ict_unit = [];
         var efficiency = [];
         var coloR = [];

         var dynamicColors = function() {
            var r = Math.floor(Math.random() * 255);
            var g = Math.floor(Math.random() * 255);
            var b = Math.floor(Math.random() * 255);
            return "rgb(" + r + "," + g + "," + b + ")";
         };
        var i=0
        {% for product in allOrders.items %}
            coloR.push(dynamicColors());
            i++;
        {% endfor %}

   // the product chart here
    var ctx = document.getElementById('productsChart').getContext('2d');
   var chart = new Chart(ctx, {
    // The type of chart we want to create
    type: 'doughnut',
    // The data for our dataset
    data: {
        labels: [
        {% for product in allOrders.items %}
        '{{product.0}}',
        {% endfor %}
        ],
        datasets: [{


            data: [
            {% for product in allOrders.items %}

                  {{product.1}},
            {% endfor %}
            ],

            label: 'Products',
            {% for product in allOrders.items %}
            backgroundColor: coloR,
            {% endfor %}
            borderWidth: 1
        }]

    },

    // Configuration options go here
    options: {}
});

</script>
{% endblock %}